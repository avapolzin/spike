

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Resampled PSFs from JWST/NIRCam Imaging &mdash; spike 1.0.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=e2a723ec"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Drizzled PSFs from HST/ACS Imaging" href="acs_example.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            spike
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation &amp; Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="psf.html">Top-level Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="psfgen.html">PSF Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="acs_example.html">Drizzled PSFs from <em>HST</em>/ACS Imaging</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Resampled PSFs from <em>JWST</em>/NIRCam Imaging</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">spike</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Resampled PSFs from <em>JWST</em>/NIRCam Imaging</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/nircam_example.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Resampled-PSFs-from-JWST/NIRCam-Imaging">
<h1>Resampled PSFs from <em>JWST</em>/NIRCam Imaging<a class="headerlink" href="#Resampled-PSFs-from-JWST/NIRCam-Imaging" title="Link to this heading"></a></h1>
<p>This example notebook shows how <code class="docutils literal notranslate"><span class="pre">spike</span></code> interacts with <em>JWST</em>/NIRCam imaging to generate a resampled PSF. This notebook uses observations the following files:</p>
<ul class="simple">
<li><p>jw02514162001_03201_00001_nrca2_cal.fits</p></li>
<li><p>jw02514162001_03201_00002_nrca2_cal.fits</p></li>
<li><p>jw02514162001_03201_00003_nrca2_cal.fits</p></li>
</ul>
<p>The easiest way to find these data in the MAST archive is by searching for observation IDs jw02514162001_03201_00001_nrca2, jw02514162001_03201_00002_nrca2, jw02514162001_03201_00003_nrca2. <code class="docutils literal notranslate"><span class="pre">spike</span></code> uses calibrated, but not-yet co-added images (i.e., “Level 2” data products), so be sure that your download includes ‘cal’ files.</p>
<p>NOTE: Environment variables are not always read in properly within Jupyter notebooks/JupyterLab – see <a class="reference external" href="https://github.com/avapolzin/spike/blob/master/example_notebooks/README.md">here</a> for some additional details of how to access them.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spike.psf</span> <span class="kn">import</span> <span class="n">jwst</span> <span class="c1"># import the relevant top-level module from spike</span>

<span class="n">datapath</span> <span class="o">=</span> <span class="s1">&#39;/path/to/nircam/data&#39;</span>
<span class="n">outputpath</span> <span class="o">=</span> <span class="s1">&#39;psfs&#39;</span> <span class="c1">#default is /psfs, defined from your working directory</span>
</pre></div>
</div>
</div>
<p>Note that if you choose to create resampled PSFs for the same data and object location using multiple PSF generation methods, you will want to define a new ‘savedir’ each time to avoid conflicts between files with the same name.</p>
<p>We’ll also define an object – in this case, a set of coordinates – for which the PSF will be generated.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="s1">&#39;10:00:31.432 +02:10:26.29&#39;</span> <span class="c1">#can also be a resolvable name or coordinates in decimal degrees</span>
</pre></div>
</div>
</div>
<p>Now, we can call <code class="docutils literal notranslate"><span class="pre">spike.psf.jwst</span></code> – as an initial example we’ll use the most minimal inputs. By default, in addition to saving drizzled PSFs and any intermediate products in the directory given by ‘savedir’ (here the argument will be the outputpath variable we definied), this function will return a dictionary that stores model PSFs indexed by filter and object.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">returnpsf</span> <span class="pre">=</span> <span class="pre">'full'</span></code> (default), the arrays in the dictionary will be the full drizzled image field of view. If <code class="docutils literal notranslate"><span class="pre">returnpsf</span> <span class="pre">=</span> <span class="pre">'crop'</span></code>, the arrays in the dictionary will be the cutout region around the object location with the size of the cutout determined by the ‘cutout_fov’ argument; the cropped region around the drizzled PSF will also be saved as a FITS file, including its WCS information (can be toggled off with <code class="docutils literal notranslate"><span class="pre">savecutout</span> <span class="pre">=</span> <span class="pre">False</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">spike</span></code> assumes that the input files have not yet been “tweaked” and handles that step for you. If your input images have been tweaked <em>or</em> if you would like to skip this step for other reasons, specify <code class="docutils literal notranslate"><span class="pre">pretweaked</span> <span class="pre">=</span> <span class="pre">True</span></code> in calling <code class="docutils literal notranslate"><span class="pre">spike.psf.jwst</span></code>. The <em>JWST</em> pipeline replaces the suffix of the tweaked files, going from ‘cal’ to ‘tweakregstep’, if you tweak the files with <code class="docutils literal notranslate"><span class="pre">spike</span></code>. As such, in addition to <code class="docutils literal notranslate"><span class="pre">pretweaked</span> <span class="pre">=</span> <span class="pre">True</span></code>, it will be necessary to set <code class="docutils literal notranslate"><span class="pre">img_type</span> <span class="pre">=</span> <span class="pre">'tweakregstep'</span></code>.
The examples in this notebook follow this convention.</p>
<p>The outputs can be very long due to all of the print statements from the tweak, PSF generation, and resampling steps. Outputs have been cleared for cells where <code class="docutils literal notranslate"><span class="pre">spike.psf.jwst</span></code> was run.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dpsf</span> <span class="o">=</span> <span class="n">jwst</span><span class="p">(</span><span class="n">img_dir</span> <span class="o">=</span> <span class="n">datapath</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="p">,</span> <span class="n">img_type</span> <span class="o">=</span> <span class="s1">&#39;cal&#39;</span><span class="p">,</span> <span class="n">inst</span> <span class="o">=</span> <span class="s1">&#39;NIRCam&#39;</span><span class="p">,</span>
           <span class="n">savedir</span> <span class="o">=</span> <span class="n">outputpath</span><span class="p">,</span> <span class="n">pretweaked</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>In this case dpsf will be very simple, since we are only looking at one set of coordinates and one filter:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dpsf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;10:00:31.432 +02:10:26.29&#39;: {&#39;F115W&#39;: array([[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         ...,
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]],
        shape=(2080, 2077), dtype=&#39;&gt;f4&#39;)}}
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">spike</span></code> can automatically plot model PSFs as they are generated, and generates PSFs regardless of whether they are plotted (or returned). To show the output drizzled PSFs here, we will plot them directly. Therefore, we will import <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> below. Since <code class="docutils literal notranslate"><span class="pre">returnpsf</span> <span class="pre">=</span> <span class="pre">'full'</span></code> by default, the array stored in dpsf shows the drizzled PSF in the context of the entire co-added image footprint. This is equivalent to reading in the image stored in ‘100031+021026_F115W_resamplestep.fits’.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">dat</span> <span class="o">=</span> <span class="n">dpsf</span><span class="p">[</span><span class="s1">&#39;10:00:31.432 +02:10:26.29&#39;</span><span class="p">][</span><span class="s1">&#39;F115W&#39;</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">dat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">20</span><span class="p">),</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">dat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">97</span><span class="p">),</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x (pix)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y (pix)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;y (pix)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/nircam_example_9_1.png" src="_images/nircam_example_9_1.png" />
</div>
</div>
<p>We can index the array to just show the PSF below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span> <span class="o">=</span> <span class="n">dpsf</span><span class="p">[</span><span class="s1">&#39;10:00:31.432 +02:10:26.29&#39;</span><span class="p">][</span><span class="s1">&#39;F115W&#39;</span><span class="p">][</span><span class="mi">1044</span><span class="p">:</span> <span class="mi">1184</span><span class="p">,</span> <span class="mi">483</span><span class="p">:</span><span class="mi">623</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">dat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">20</span><span class="p">),</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">dat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">97</span><span class="p">),</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">483</span><span class="p">,</span> <span class="mi">623</span><span class="p">,</span> <span class="mi">1044</span><span class="p">,</span> <span class="mi">1184</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x (pix)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y (pix)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;y (pix)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/nircam_example_11_1.png" src="_images/nircam_example_11_1.png" />
</div>
</div>
<p>By default, PSFs are generated for <code class="docutils literal notranslate"><span class="pre">spike.psf.jwst</span></code> by <code class="docutils literal notranslate"><span class="pre">WebbPSF</span></code> for a 6 arcsec x 6 arcsec region; users have complete control over the specifics of the PSF generation with keyword arguments for <code class="docutils literal notranslate"><span class="pre">spike.psfgen.jwpsf</span></code> and the optional dictionary <code class="docutils literal notranslate"><span class="pre">calckwargs</span></code> which is a keyword argument for <code class="docutils literal notranslate"><span class="pre">spike.psf.jwst</span></code> and feeds additional keyword arguments to <code class="docutils literal notranslate"><span class="pre">WebbPSF</span></code> when the it’s called by <code class="docutils literal notranslate"><span class="pre">spike</span></code>.</p>
<p>One advantage of <code class="docutils literal notranslate"><span class="pre">spike</span></code> is that it can be used flexibly with a variety of different PSF generation methods – to change which one is used, simply use the ‘method’ argument. Built-in options are:</p>
<ul class="simple">
<li><p>‘WebbPSF’</p></li>
<li><p>‘STDPSF’</p></li>
<li><p>‘epsf’</p></li>
<li><p>‘PSFEx’</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">'USER'</span></code>, then the keyword argument ‘usermethod’ must also be specified, pointing to either a function or a directory that houses model PSFs that follow the [imgprefix]_[coords]_[band]_topsf.fits, e.g., imgprefix_23.31+30.12_F814W_topsf.fits or imgprefix_195.78-46.52_F555W_topsf.fits naming scheme.</p>
<p>We’ll use STDPSFs below and have <code class="docutils literal notranslate"><span class="pre">spike</span></code> output cutouts around the resampled PSF.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dpsf</span> <span class="o">=</span> <span class="n">jwst</span><span class="p">(</span><span class="n">img_dir</span> <span class="o">=</span> <span class="n">datapath</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="p">,</span> <span class="n">img_type</span> <span class="o">=</span> <span class="s1">&#39;tweakregstep&#39;</span><span class="p">,</span> <span class="n">inst</span> <span class="o">=</span> <span class="s1">&#39;NIRCam&#39;</span><span class="p">,</span>
           <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;STDPSF&#39;</span><span class="p">,</span> <span class="n">savedir</span> <span class="o">=</span> <span class="n">outputpath</span><span class="p">,</span> <span class="n">pretweaked</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dpsf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;10:00:31.432 +02:10:26.29&#39;: {&#39;F115W&#39;: array([[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         ...,
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]],
        shape=(2080, 2077), dtype=&#39;&gt;f4&#39;)}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span> <span class="o">=</span> <span class="n">dpsf</span><span class="p">[</span><span class="s1">&#39;10:00:31.432 +02:10:26.29&#39;</span><span class="p">][</span><span class="s1">&#39;F115W&#39;</span><span class="p">]</span>
<span class="n">datcrop</span> <span class="o">=</span> <span class="n">dpsf</span><span class="p">[</span><span class="s1">&#39;10:00:31.432 +02:10:26.29&#39;</span><span class="p">][</span><span class="s1">&#39;F115W&#39;</span><span class="p">][</span><span class="mi">1044</span><span class="p">:</span> <span class="mi">1184</span><span class="p">,</span> <span class="mi">483</span><span class="p">:</span><span class="mi">623</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gridspec_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span><span class="mf">0.4</span><span class="p">})</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">dat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">20</span><span class="p">),</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">dat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">90</span><span class="p">),</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (pix)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y (pix)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">datcrop</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">483</span><span class="p">,</span> <span class="mi">623</span><span class="p">,</span> <span class="mi">1044</span><span class="p">,</span> <span class="mi">1184</span><span class="p">],</span>
             <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">datcrop</span><span class="p">[</span><span class="n">datcrop</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">20</span><span class="p">),</span>
             <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">datcrop</span><span class="p">[</span><span class="n">datcrop</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">90</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (pix)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y (pix)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;y (pix)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/nircam_example_15_1.png" src="_images/nircam_example_15_1.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">spike</span></code> can also be used to generate PSFs for multiple objects/coordinates simultaneously. We’ll do this using the default <code class="docutils literal notranslate"><span class="pre">WebbPSF</span></code> parameters below.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;10:00:31.432 +02:10:26.29&#39;</span><span class="p">,</span> <span class="s1">&#39;10:00:31.0132 +02:09:53.23&#39;</span><span class="p">]</span>

<span class="n">dpsf</span> <span class="o">=</span> <span class="n">jwst</span><span class="p">(</span><span class="n">img_dir</span> <span class="o">=</span> <span class="n">datapath</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="p">,</span> <span class="n">img_type</span> <span class="o">=</span> <span class="s1">&#39;tweakregstep&#39;</span><span class="p">,</span> <span class="n">inst</span> <span class="o">=</span> <span class="s1">&#39;NIRCam&#39;</span><span class="p">,</span>
           <span class="n">savedir</span> <span class="o">=</span> <span class="n">outputpath</span><span class="p">,</span> <span class="n">pretweaked</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">returnpsf</span> <span class="o">=</span> <span class="s1">&#39;crop&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dpsf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;10:00:31.432 +02:10:26.29&#39;: {&#39;F115W&#39;: array([[1.37165355e-08, 1.16727819e-08, 1.33040219e-08, ...,
          4.02859328e-08, 3.59869610e-08, 3.28664029e-08],
         [1.65953118e-08, 1.43423229e-08, 1.25833477e-08, ...,
          4.12311536e-08, 3.79603335e-08, 3.89721677e-08],
         [1.84145463e-08, 1.79218329e-08, 1.58013744e-08, ...,
          4.06137133e-08, 4.09517433e-08, 4.18358930e-08],
         ...,
         [3.83971290e-08, 3.83771841e-08, 3.44180719e-08, ...,
          1.55508868e-08, 1.90290628e-08, 2.28565380e-08],
         [3.66434811e-08, 3.28258913e-08, 2.74249743e-08, ...,
          1.52441846e-08, 1.50736046e-08, 1.89214298e-08],
         [3.07511030e-08, 2.62706230e-08, 2.68563127e-08, ...,
          1.78912902e-08, 1.42374823e-08, 1.39539580e-08]],
        shape=(151, 151), dtype=&#39;&gt;f4&#39;)},
 &#39;10:00:31.0132 +02:09:53.23&#39;: {&#39;F115W&#39;: array([[1.2495302e-08, 1.2049310e-08, 1.5706604e-08, ..., 3.6155981e-08,
          3.2709121e-08, 3.3963385e-08],
         [1.5624083e-08, 1.3093305e-08, 1.3421471e-08, ..., 3.8799485e-08,
          3.8132285e-08, 4.0233864e-08],
         [1.7809068e-08, 1.6633747e-08, 1.4614938e-08, ..., 4.1146436e-08,
          4.2308486e-08, 4.2098378e-08],
         ...,
         [3.9157708e-08, 3.4546066e-08, 2.7063223e-08, ..., 1.9011868e-08,
          2.2318476e-08, 2.1101110e-08],
         [3.3559523e-08, 2.6205218e-08, 2.7187843e-08, ..., 1.5094358e-08,
          1.8792166e-08, 2.1941874e-08],
         [2.4878196e-08, 2.6584608e-08, 3.1188179e-08, ..., 1.4225273e-08,
          1.4145965e-08, 1.8265757e-08]], shape=(151, 151), dtype=&#39;&gt;f4&#39;)}}
</pre></div></div>
</div>
<p>Since we’ve selected <code class="docutils literal notranslate"><span class="pre">returnpsf</span> <span class="pre">=</span> <span class="pre">'crop'</span></code>, the output array is already cropped to the immediate region around the PSF. Selecting both <code class="docutils literal notranslate"><span class="pre">returnpsf</span> <span class="pre">=</span> <span class="pre">'crop'</span></code> and <code class="docutils literal notranslate"><span class="pre">savecutout</span> <span class="pre">=</span> <span class="pre">True</span></code> (default), will save a FITS file that stores the cropped resampled PSF – the name is the same as the for the full saved image with ‘_crop’ appended.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span> <span class="o">=</span> <span class="n">dpsf</span><span class="p">[</span><span class="s1">&#39;10:00:31.432 +02:10:26.29&#39;</span><span class="p">][</span><span class="s1">&#39;F115W&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gridspec_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span><span class="mf">0.4</span><span class="p">})</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">dat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">20</span><span class="p">),</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">dat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">90</span><span class="p">),</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (pix)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y (pix)&#39;</span><span class="p">)</span>

<span class="n">dat</span> <span class="o">=</span> <span class="n">dpsf</span><span class="p">[</span><span class="s1">&#39;10:00:31.0132 +02:09:53.23&#39;</span><span class="p">][</span><span class="s1">&#39;F115W&#39;</span><span class="p">]</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">dat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">20</span><span class="p">),</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">dat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">90</span><span class="p">),</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Greys&#39;</span><span class="p">,)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (pix)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y (pix)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;y (pix)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/nircam_example_20_1.png" src="_images/nircam_example_20_1.png" />
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="acs_example.html" class="btn btn-neutral float-left" title="Drizzled PSFs from HST/ACS Imaging" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Ava Polzin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>